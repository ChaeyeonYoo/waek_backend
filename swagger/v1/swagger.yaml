---
openapi: 3.0.1
info:
  title: 왹왹이(waek) API
  version: v1
  description: 왹왹이 iOS 앱을 위한 RESTful API 서버
  contact:
    name: API Support
paths:
  "/auth/social_login":
    post:
      summary: 소셜 로그인
      tags:
      - 인증
      description: 소셜 로그인을 통해 JWT 토큰을 발급받습니다.
      parameters: []
      responses:
        '200':
          description: 로그인 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: JWT 토큰
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      nickname:
                        type: string
                      profile_image_key:
                        type: integer
                        nullable: true
                      provider:
                        type: integer
                      is_premium:
                        type: boolean
        '400':
          description: 필수 파라미터 누락
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '422':
          description: 유효성 검사 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                provider:
                  type: integer
                  description: '소셜 로그인 제공자: 1 (Apple), 2 (Kakao), 3 (Google)'
                  example: 1
                provider_user_id:
                  type: string
                  description: 소셜 로그인 제공자에서 받은 유저 고유 ID
                  example: apple_user_12345
                nickname:
                  type: string
                  description: 사용자 닉네임
                  example: 홍길동
                social_email:
                  type: string
                  description: 소셜 로그인 이메일 (선택사항)
                  example: user@example.com
                profile_image_key:
                  type: integer
                  description: 프로필 이미지 키 (선택사항)
                  example: 1
              required:
              - provider
              - provider_user_id
              - nickname
  "/daily_workouts/{date}":
    get:
      summary: 특정 날짜의 일일 요약 조회
      tags:
      - 일일 요약
      description: 특정 날짜의 일일 요약 정보를 조회합니다.
      security:
      - bearerAuth: []
      parameters:
      - name: date
        in: path
        format: date
        required: true
        description: 조회할 날짜 (YYYY-MM-DD)
        example: '2024-11-15'
        schema:
          type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    nullable: true
                  user_id:
                    type: integer
                  date:
                    type: string
                  is_workout_goal_achieved:
                    type: boolean
                  has_walk_10min:
                    type: boolean
                  created_at:
                    type: string
                    nullable: true
                  updated_at:
                    type: string
                    nullable: true
        '400':
          description: 날짜 파라미터 누락
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/daily_workouts":
    get:
      summary: 일일 요약 목록 조회
      tags:
      - 일일 요약
      description: 날짜 범위의 일일 요약 목록을 조회합니다.
      security:
      - bearerAuth: []
      parameters:
      - name: start_date
        in: query
        format: date
        required: false
        description: 시작 날짜 (YYYY-MM-DD)
        schema:
          type: string
      - name: end_date
        in: query
        format: date
        required: false
        description: 종료 날짜 (YYYY-MM-DD)
        schema:
          type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    user_id:
                      type: integer
                    date:
                      type: string
                    is_workout_goal_achieved:
                      type: boolean
                    has_walk_10min:
                      type: boolean
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/feedbacks":
    post:
      summary: 피드백 저장
      tags:
      - 피드백
      description: 사용자 피드백을 저장합니다.
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: 피드백 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  user_id:
                    type: integer
                  content:
                    type: string
                  app_version:
                    type: string
                    nullable: true
                  platform:
                    type: string
                  created_at:
                    type: string
                  updated_at:
                    type: string
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '422':
          description: 유효성 검사 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                feedback:
                  type: object
                  properties:
                    content:
                      type: string
                      description: 피드백 내용
                      example: 앱이 정말 좋아요! 계속 사용하고 싶습니다.
                    app_version:
                      type: string
                      description: 앱 버전 (선택사항)
                      example: 1.0.0
                    platform:
                      type: string
                      description: 플랫폼
                      example: ios
                  required:
                  - content
                  - platform
  "/share_cards":
    post:
      summary: 카드 저장
      tags:
      - 카드
      description: 산책 결과를 공유할 수 있는 카드를 저장합니다.
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: 카드 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  user_id:
                    type: integer
                  workout_id:
                    type: integer
                  card_date:
                    type: string
                  frame_theme_key:
                    type: string
                    nullable: true
                  image_url:
                    type: string
                    nullable: true
                  distance:
                    type: string
                    nullable: true
                  steps:
                    type: integer
                    nullable: true
                  duration:
                    type: integer
                    nullable: true
                  created_at:
                    type: string
                  updated_at:
                    type: string
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '422':
          description: 유효성 검사 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                share_card:
                  type: object
                  properties:
                    workout_id:
                      type: integer
                      description: 연결된 Workout ID
                      example: 1
                    card_date:
                      type: string
                      format: date
                      description: 카드에 표시되는 날짜
                      example: '2024-11-15'
                    frame_theme_key:
                      type: string
                      description: 프레임/테마 키
                      example: theme_1
                    image_url:
                      type: string
                      description: 완성된 카드 이미지 URL
                      example: https://example.com/cards/card_123.jpg
                    distance:
                      type: number
                      format: float
                      description: 거리 (미터)
                      example: 2500.5
                    steps:
                      type: integer
                      description: 걸음수
                      example: 3500
                    duration:
                      type: integer
                      description: 지속 시간 (초)
                      example: 1800
                  required:
                  - workout_id
                  - card_date
    get:
      summary: 카드 조회
      tags:
      - 카드
      description: 저장된 카드를 조회합니다.
      security:
      - bearerAuth: []
      parameters:
      - name: date
        in: query
        format: date
        required: false
        description: 특정 날짜의 카드만 조회 (YYYY-MM-DD). 없으면 모든 카드 조회
        schema:
          type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    user_id:
                      type: integer
                    workout_id:
                      type: integer
                    card_date:
                      type: string
                    frame_theme_key:
                      type: string
                      nullable: true
                    image_url:
                      type: string
                      nullable: true
                    distance:
                      type: string
                      nullable: true
                    steps:
                      type: integer
                      nullable: true
                    duration:
                      type: integer
                      nullable: true
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/workouts":
    post:
      summary: 산책 기록 저장
      tags:
      - 산책 기록
      description: 새로운 산책 세션을 저장합니다.
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: 산책 기록 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  user_id:
                    type: integer
                  workout_date:
                    type: string
                  started_at:
                    type: string
                  ended_at:
                    type: string
                  distance:
                    type: string
                    nullable: true
                  steps:
                    type: integer
                    nullable: true
                  duration:
                    type: integer
                  calories:
                    type: string
                    nullable: true
                  created_at:
                    type: string
                  updated_at:
                    type: string
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '422':
          description: 유효성 검사 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                workout:
                  type: object
                  properties:
                    workout_date:
                      type: string
                      format: date
                      example: '2024-11-15'
                    started_at:
                      type: string
                      format: date-time
                      example: '2024-11-15T10:00:00Z'
                    ended_at:
                      type: string
                      format: date-time
                      example: '2024-11-15T10:30:00Z'
                    distance:
                      type: number
                      format: float
                      description: 거리 (미터)
                      example: 2500.5
                    steps:
                      type: integer
                      description: 걸음수
                      example: 3500
                    duration:
                      type: integer
                      description: 지속 시간 (초)
                      example: 1800
                    calories:
                      type: number
                      format: float
                      description: 소모 칼로리
                      example: 120.5
                  required:
                  - workout_date
                  - started_at
                  - ended_at
                  - duration
    get:
      summary: 산책 기록 조회
      tags:
      - 산책 기록
      description: 저장된 산책 기록을 조회합니다.
      security:
      - bearerAuth: []
      parameters:
      - name: date
        in: query
        format: date
        required: false
        description: 특정 날짜의 기록만 조회 (YYYY-MM-DD). 없으면 모든 기록 조회
        schema:
          type: string
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    user_id:
                      type: integer
                    workout_date:
                      type: string
                    started_at:
                      type: string
                    ended_at:
                      type: string
                    distance:
                      type: string
                      nullable: true
                    steps:
                      type: integer
                      nullable: true
                    duration:
                      type: integer
                    calories:
                      type: string
                      nullable: true
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
servers:
- url: http://localhost:3000
  description: Development server
- url: https://{defaultHost}
  variables:
    defaultHost:
      default: your-production-server.com
  description: Production server
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
